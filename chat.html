<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live Chat â€“ LagneshMitra</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>

<body>

<nav>
  <div class="brand">LagneshMitra</div>
  <div class="nav-links">
    <a href="index.html">Home</a>
    <a href="report.html">Reports</a>
    <a href="contact.html">Contact</a>
  </div>
</nav>

<div class="main">
  <h2>Live Chat</h2>
  <p>Please write your message. We usually respond shortly.</p>

  <div style="background:#111;padding:15px;border-radius:12px;">
    <div style="color:#aaa;font-size:14px;margin-bottom:10px;">
      ğŸŸ¢ Advisor online
    </div>

    <textarea
      id="msg"
      placeholder="Type your message..."
      style="width:100%;height:120px;
      background:#000;color:#fff;
      border:1px solid #333;
      border-radius:10px;padding:12px;"
    ></textarea>

    <br><br>

    <button class="button" onclick="sendMsg()">Send</button>

    <p id="status" style="color:#6cff6c;margin-top:12px;"></p>
  </div>
</div>

<!-- ğŸ”¥ FIREBASE CHAT BACKBONE -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // ğŸ” Firebase Config (tumhara)
  const firebaseConfig = {
    apiKey: "AIzaSyCX8yGRJc5AcxSEaaC6AzNLZzxtOCz83Sk",
    authDomain: "lagneshmitra-e57b8.firebaseapp.com",
    projectId: "lagneshmitra-e57b8",
    storageBucket: "lagneshmitra-e57b8.firebasestorage.app",
    messagingSenderId: "420798143606",
    appId: "1:420798143606:web:4d73ee3c6d4a938b415357"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ğŸŒ Expose function globally for button
  window.sendMsg = async function () {
    const input = document.getElementById("msg");
    const status = document.getElementById("status");
    const text = input.value.trim();

    if (!text) {
      alert("Please type a message");
      return;
    }

    status.style.color = "#aaa";
    status.innerText = "Sending...";

    try {
      await addDoc(collection(db, "chats"), {
        message: text,
        sender: "user",
        status: "unread",
        timestamp: serverTimestamp()
      });

      input.value = "";
      status.style.color = "#6cff6c";
      status.innerText = "âœ” Message sent. Please wait for response.";

    } catch (err) {
      console.error(err);
      status.style.color = "#ff6c6c";
      status.innerText = "âŒ Error sending message. Please try again.";
    }
  };
</script>

</body>
</html>
